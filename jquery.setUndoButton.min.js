!function(t){t.fn.extend({setUndoButton:function(e){function n(e){this.target=t(e),this.onClick=function(t){return this.target.off("click.undo").on("click.undo",t),this},this.execute=function(t){return clearInterval(this.target.data("interval")),t instanceof Function&&t.apply(t,this.target),this},this.resetData=function(){return this.target.html(this.target.data("originalText")).data("time",s.time),this},this.setData=function(t){return this.target.data(t),this},this.setText=function(){return this.target.html(s.text+(s.countdown?" ("+this.target.data("time")+"s)":"")),this},this.setInterval=function(){var t=setInterval(function(t){new n(t).checkTimeout()},1e3,this.target);this.target.data("interval",t)},this.checkTimeout=function(){this.setData({time:parseInt(this.target.data("time"))-1}).setText(),this.target.data("time")<=0&&this.execute(s.onTimeout)}}function i(t){t.preventDefault(),new n(this).onClick(a).execute(s.onClick).resetData().setText().setInterval()}function a(t){t.preventDefault(),new n(this).onClick(i).execute(s.onUndo).resetData()}this.defaultOptions={time:5,text:"undo",countdown:!0,onUndo:function(){},onClick:function(){},onTimeout:function(){}};var s=t.extend({},this.defaultOptions,e);return this.each(function(){new n(this).onClick(i).setData({originalText:this.innerHTML})})}})}(jQuery);